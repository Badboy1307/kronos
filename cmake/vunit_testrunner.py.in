# Copyright (c) 2020 Sonal Pinto
# SPDX-License-Identifier: Apache-2.0

import os
from vunit import VUnitCLI
from vunit.verilog import VUnit

test_name = "@ARG_NAME@"

cli = VUnitCLI()
args = cli.parse_args()
args.output_path = "@TEST_OUTPUT_DIR@"

vu = VUnit.from_args(args=args)

lib = vu.add_library('lib')

source_files = "@TEST_SOURCES@".split(';')
for f in source_files:
    lib.add_source_files(f)

# Additional runtime config
dump_wave = '-do "add wave -r *"'
sv_seed = ''

if 'SV_SEED' in os.environ:
    seed = os.environ['SV_SEED']
    print("SV_SEED: ", seed)
    sv_seed = "-sv_seed {}".format(seed)

vu.set_sim_option("modelsim.vsim_flags", [dump_wave, sv_seed])

vu.main()
